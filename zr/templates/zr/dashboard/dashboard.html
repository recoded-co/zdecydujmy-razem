{% extends "zr/base.html" %}
{% load i18n %}
{% load url from future %}
{% load isloged %}
{% load avatar_tags %}

{% block extra_head %}

    <!--<script src="/static/js/jquery-1.9.1.js"></script>
    <script src="/static/js/jquery-ui.js"></script>-->
    <script src="/static/js/jquery-1.9.1.js"></script>

    <script type="text/javascript">

        var viewportwidth,viewportheight;
        var margin_gap=20;

        $(document).ready(function(){
            var max,min;
            var navSidebarWidth =  $('#resizible_jquery').width();
            $('ul.nav-tabs').css('width',navSidebarWidth+"px");
            $('.toolbox').css('width',navSidebarWidth+"px");
            configuration.setAuthor('{{ user.id }}');
            configuration.setPlanId('{{ plan_id }}');
            page_init();
                                              
            $(window).resize(function(){
             var navSidebarWidth =  $('#resizible_jquery').width();
             $('ul.nav-tabs').css('width',navSidebarWidth+"px");
             $('.toolbox').css('width',navSidebarWidth+"px");
            });
           
           $('body').resize(function(){
               var viewportwidth = parseInt($('#row_box').innerWidth()) - margin_gap -1;
                max =  parseInt((viewportwidth*parseInt("{{ configuration.max }}"))/100);
                min =  parseInt((viewportwidth*parseInt("{{ configuration.min }}"))/100);
              
               $( "#resizible_jquery" ).resizable({
                  maxWidth: max,
                  minWidth: min,
                  handles: 'e, w'
                });
           });
           $( "#resizible_jquery" ).resizable({
              maxWidth: max,
              minWidth: min,
              handles: 'e, w'
            });
        });
       
        </script>
{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="/static/css/jquery-ui.css" />
    <link rel="stylesheet" href="/static/js/bootstrap-lightbox/bootstrap-lightbox.min.css" />
    <link href="/static/css/dashboard.css" rel="stylesheet"/>
    <link rel="stylesheet" href="/static/css/leaflet.css" />
    <!--<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.css" />-->
    <!--[if lte IE 8]>
     <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.ie.css" />
     <link rel="stylesheet" href="/static/css/L.Control.Zoomslider.ie.css" />
     <link rel="stylesheet" href="/static/css/leaflet.draw.ie.css" />
    <![endif]-->
    <link rel="stylesheet" href="/static/css/L.Control.Zoomslider.css" />
    <link rel="stylesheet" href="/static/css/leaflet.draw.css" />
    <link rel="stylesheet" href="/static/css/MarkerCluster.css" />
	<link rel="stylesheet" href="/static/css/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="/static/js/leaflet.measure/leaflet.measure/leaflet.measure.css" />
    <!--<link rel="stylesheet" href="/static/js/Leaflet.MeasureControl/leaflet.measurecontrol.css" />-->
    <link rel="stylesheet" href="/static/css/jasny-bootstrap.min.css"/>
    <link rel="stylesheet" href="/static/js/LeafletTileLegend/Leaflet.TileLegend.css"/>
    <link rel="stylesheet" href="/static/angular/bower_components/angular-bootstrap-datetimepicker/src/css/datetimepicker.css"/>
    <link rel="stylesheet" href="/static/js/Font-Awesome/css/font-awesome.min.css"/>

    <!--<link rel="stylesheet" href="/static/js/bootstrap-datepicker/css/datepicker.css"/>-->
{% endblock %}

{% block extrajs %}
    <script src="/static/js/jquery-ui.js"></script>
    <script src="/static/js/initialization.js" type="text/javascript"></script>

    <script src="/static/angular/angular.js"></script>
    <script src="/static/angular/angular-route.js"></script>
    <script src="/static/angular/angular-cookies.js"></script>
    <script src="/static/angular/angular-strap.min.js"></script>
    <script src="/static/angular/filters.js"></script>
    <script src="/static/angular/bower_components/moment/moment.js"></script>
    <script src="/static/angular/bower_components/angular-bootstrap-datetimepicker/src/js/datetimepicker.js"></script>
    <script src="/static/angular/controllers.js"></script>
    <script src="/static/angular/services.js"></script>
    <script src="/static/angular/app.js"></script>
    <script src="/static/angular/directives.js"></script>
    <script src="/static/angular/angular-resource.js"></script>
    <script src="/static/angular/bower_components/angularytics/src/angularytics.js"></script>
    <script src="/static/angular/bower_components/angularytics/src/consoleHandler.js"></script>
    <script src="/static/angular/angularyticsDataHandler.js"></script>
    <script src="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.js?2"></script>
    <script src="http://matchingnotes.com/javascripts/leaflet-google.js"></script> <!-- nowy -->
    <script src="/static/js/L.Control.Zoomslider.js"></script>
    <script src="/static/js/Leaflet.draw.js" />
    <script src="/static/js/edit/handler/Edit.Poly.js"></script>
	<script src="/static/js/edit/handler/Edit.SimpleShape.js"></script>
	<script src="/static/js/edit/handler/Edit.Circle.js"></script>
	<script src="/static/js/edit/handler/Edit.Rectangle.js"></script>

	<script src="/static/js/draw/handler/Draw.Feature.js"></script>
	<script src="/static/js/draw/handler/Draw.Polyline.js"></script>
	<script src="/static/js/draw/handler/Draw.Polygon.js"></script>
	<script src="/static/js/draw/handler/Draw.SimpleShape.js"></script>
	<script src="/static/js/draw/handler/Draw.Rectangle.js"></script>
	<script src="/static/js/draw/handler/Draw.Circle.js"></script>
	<script src="/static/js/draw/handler/Draw.Marker.js"></script>

	<script src="/static/js/ext/LatLngUtil.js"></script>
	<script src="/static/js/ext/GeometryUtil.js"></script>
	<script src="/static/js/ext/LineUtil.Intersect.js"></script>
	<script src="/static/js/ext/Polyline.Intersect.js"></script>
	<script src="/static/js/ext/Polygon.Intersect.js"></script>

	<script src="/static/js/Control.Draw.js"></script>
	<script src="/static/js/Tooltip.js"></script>
	<script src="/static/js/Toolbar.js"></script>
    <script src="/static/js/legende.js"></script>
    <script src="/static/js/LeafletTileLegend/Leaflet.TileLegend.js"></script>

	<script src="/static/js/draw/DrawToolbar.js"></script>
	<script src="/static/js/edit/EditToolbar.js"></script>
	<script src="/static/js/edit/handler/EditToolbar.Edit.js"></script>
	<script src="/static/js/edit/handler/EditToolbar.Delete.js"></script>

    <script src="/static/js/wicket.src.js"></script>
    <script src="/static/js/wicket-leaflet.src.js"></script>
    <script src="/static/js/leaflet.markercluster-src.js"></script>
    <script src="/static/js/leaflet.draw.new.js"></script>
    <script src="/static/angular/bower_components/angularytics/src/trackEventFilter.js"></script>
    <script src="/static/js/leaflet.measure/leaflet.measure/leaflet.measure.js"></script>
    <!--<script src="/static/js/Leaflet.MeasureControl/leaflet.measurecontrol.js"></script>-->
    <script src="/static/js/leaflet.measure/leaflet.measure.polygon/leaflet.measure.polygon.js"></script>
    <script src="/static/js/jasny-bootstrap.min.js"></script>
{% endblock %}

{% block onload %} map_init();resize();page_init(); {% endblock %}
{% block onresize %} resize(); {% endblock %}

{% block navbar %}{% endblock %}

{% block content %}
<div id="row_box" class="row dashbord_map" ng-app="zd">
   
  <div id="middleman"></div>
  <div id="resizible_jquery" class="col-xs-12 col-sm-6 col-md-5 delpadding" style="float:right;">
      <div id="div_apiList" ng-controller="apiList" >

      <ul id="nav-tabs-menu" class="nav nav-tabs">
          <li class="active" ng-click="console.log('dddd')"><a href="#details" data-toggle="tab"><i class="fa fa-comments fa-fw"></i>SZCZEGÓŁY</a></li>
          <li><a href="#subscriptions" data-toggle="tab"><i class="fa fa-thumb-tack fa-fw"></i>ŚLEDZĘ</a></li>
          <li><a href="#all" data-toggle="tab"><i class="fa fa-square fa-fw"></i>CAŁOŚĆ</a></li>
          <li>
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <div class="img-circle">{% avatar user 20 %}&nbsp;{{ user }}</div>
                  <!--<img src="/static/images/face.jpeg" alt="avatar" width="20px" height="20px" class="img-circle">-->

                  <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                  <li><a href="{% url 'django.contrib.auth.views.logout_then_login' %}">{% trans "Wyloguj" %}</a></li>
                  <li><a href="{% url 'avatar_change2' %}">Change your avatar</a></li>
              </ul>
          </li>
      </ul>

      <div class="tab-content">
          <div class="tab-pane active" id="details" >
                {% include "zr/dashboard/elements/details.html" %}
          </div>

          <div class="tab-pane" id="subscriptions">
                {% include "zr/dashboard/elements/subscriptions.html" %}
          </div>

          <div class="tab-pane" id="all">
                {% include "zr/dashboard/elements/all.html" %}
          </div>
        </div>

        <div>
            <script type="text/ng-template"  id="tree_item_renderer.html">
                {% include "zr/dashboard/elements/post_area.html" %}
            </script>

            <div ng-if="post.nodes.length>0" class="tab_border" ng-hide="!(post.rozwin!=undefined && post.rozwin==true) && showallposts" >
                <div ng-repeat="post in post.nodes "
                     ng-include="'tree_item_renderer.html'">
                </div>
            </div>
        </div>
            <script  type="text/ng-template"  id="search.html">
                {% include "zr/dashboard/elements/popover_search.html" %}
            </script>
  </div>
</div>
  <div id="mapsquare" class="col-xs-12 col-sm-6 col-md-8 ui-widget-content delpadding" style="float:{{ configuration.side|dirparser }}">
  <!-- <div id="mapsquare" class="col-xs-12 col-sm-6 col-md-7 ui-widget-content delpadding"> -->
        <div id="map-search" class="input-group input-group-sm double-input">
                <input id="map-search-input" class="form-control ng-pristine ng-valid" >

            <div class="input-group-btn">
                <button id="map-search-button" class="btn" style="border-right-width: 0px;border-radius: 0px;"><i class="fa fa-search fa-fw"></i>szukaj</button>
            </div>

        </div>
        {% include "zr/dashboard/map2.html" %}
  </div>
{% endblock %}